<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Purely Trace</title>

    <!-- CSS FILES -->                
    <!-- CSS FILES -->                
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-icons.css" rel="stylesheet">
    <link href="css/templatemo-tiya-golf-club.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<style>
    /* Reset and Fonts */
    * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
        }

        /* Navbar */
        .navbar {
            background-color: #81B29A;
        }

        .navbar-brand img {
            height: 50px;
        }

        .navbar a {
            color: #fff;
        }

        /* Fullscreen Image */
        .header-image {
            width: 100%;
            height: 400px;
            background: url('https://static.wixstatic.com/media/c09e48_dccd2ea8b1b14a65af2edf5e9f3c70dc~mv2.jpg') center/cover no-repeat;
        }

        /* Header Section */
        header {
            text-align: center;
            padding: 4rem 0; /* Adjusted the padding */
            margin-top: 20px; /* Add some margin to create space between the navbar and header */
        }
    </style>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">                
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <img src="images/Farm Logo.jpeg" class="navbar-brand-image img-fluid" alt="">
                <span class="navbar-brand-text">
                    Purely
                    <small>Trace</small>
                </span>
            </a>
    
            <div class="d-lg-none ms-auto me-3">
                <a class="btn custom-btn custom-border-btn" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">Login</a>
            </div>
    
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
    
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-lg-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="Farmer.html">General Information</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Raw Milk.html">Raw Milk</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Shipping</a>
                    </li>
                </ul>
    
                <div class="d-none d-lg-block ms-lg-3">
                    <a class="btn custom-btn custom-border-btn d-flex align-items-center" href="#" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                        <img src="/Users/porfai/Downloads/profile.png" alt="Profile Icon" class="rounded-circle me-2" style="width: 30px; height: 30px;">
                        <span id="username">Username</span>
                    </a>                </div>
            </div>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- Header Section -->
    <header class="text-center py-4">
        <h1>Raw Milk Data</h1>
    </header>
    <!-- Header Section End -->

    <!-- Detail Section-->
    <table id="dataTable">
        <thead>
            <tr>
                <th>Field</th>
                <th>Value</th>
            </tr>        
        </thead>
        <tbody>
            <tr>
                <td>Person in Charge</td>
                <td id="displayPersonInCharge"></td>
            </tr>
            <tr>
                <td>Milk Tank Number</td>
                <td id="displayMilkTankNum"></td>
            </tr>
            <tr>
                <td>Quantity</td>
                <td id="displayQuantity"></td>
            </tr>
            <tr>
                <td>QUantity Unit</td>
                <td id="displayQuantityUnit"></td>
            </tr>
            <tr>
                <td>Temperature</td>
                <td id="displayTemperature"></td>
            </tr>
            <tr>
                <td>Temperature Unit</td>
                <td id="displayTemperatureUnit"></td>
            </tr>
            <tr>
                <td>pH</td>
                <td id="displayQualityPh"></td>
            </tr>
            <tr>
                <td>Fat</td>
                <td id="displayQualityFat"></td>
            </tr>
            <tr>
                <td>Protein</td>
                <td id="displayQualityProtein"></td>
            </tr>
            <tr>
                <td>Bacterial Testing</td>
                <td id="displayBacterialTesting"></td>
            </tr>
            <tr>
                <td>Contaminants</td>
                <td id="displayContaminants"></td>
            </tr>
            <tr>
                <td>Abnormal Characteristics</td>
                <td id="displayAbnormalCharacteristics"></td>
            </tr>
            <tr>
                <td>Address</td>
                <td id="displayAddress"></td>
            </tr>
            <tr>
                <td>Location</td>
                <td id="displayLocation"></td>
            </tr>
        </tbody>  
    </table>
    <div clss="QRCandBC">
        <h1>QR Code and Barcode Generator</h1>
        <div class="Barcode">
            <!--Input Field to Simulate Barcode Scan-->
            <h2>Scan Barcode (Simulated)</h2>
            <input type="text" id="barcodeInput" placeholder="Scan Barcode or Enter ID">
            <button onclick="scanBarcode()">Scan Barcode</button>
        </div>
        <div class="QRcode">
            <!--Input Field to Simulate QR Code Scan-->
            <h2>Scan QR Code (Simulated)</h2>
            <input type="text" id="qrInput" placehloder="Scan QR Code or Enter Data">
            <button onclick="scanQR()">Scan QR Code</button>
        </div>
    </div>
    <!-- Displays QR Code and Barcode -->
     <div id="qrcode"></div>
     <div id="barcode"></div>

     <!-- Footer Start -->
    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-12 me-auto mb-5 mb-lg-0">
                    <a class="navbar-brand d-flex align-items-center" href="index.html">
                        <img src="images/Farm Logo.jpeg" class="navbar-brand-image img-fluid" alt="">
                        <span class="navbar-brand-text">
                            Purely
                            <small>Trace</small>
                        </span>
                    </a>
                </div>
                <div class="col-lg-3 col-12">
                    <h5 class="site-footer-title mb-4">Contact Us</h5>
                    <p class="d-flex border-bottom pb-3 mb-3 me-lg-3">
                        <span>Nawisa Thanasuttawong</span>
                        64070264@kmitl.ac.th
                    </p>
                    <p class="d-flex me-lg-3">
                        <span>Pinya Nuangudom</span>
                        64070266@kmitl.ac.th
                    </p>
                </div>
                <div class="col-lg-2 col-12 ms-auto">
                    <ul class="social-icon mt-lg-5 mt-3 mb-4">
                        <li class="social-icon-item">
                            <a href="#" class="social-icon-link bi-instagram"></a>
                        </li>
                        <li class="social-icon-item">
                            <a href="#" class="social-icon-link bi-twitter"></a>
                        </li>
                        <li class="social-icon-item">
                            <a href="#" class="social-icon-link bi-whatsapp"></a>
                        </li>
                    </ul>  
                </div>
            </div>
        </div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
            <path fill="#81B29A" fill-opacity="1" d="M0,224L34.3,192C68.6,160,137,96,206,90.7C274.3,85,343,139,411,144C480,149,549,107,617,122.7C685.7,139,754,213,823,240C891.4,267,960,245,1029,224C1097.1,203,1166,181,1234,160C1302.9,139,1371,117,1406,106.7L1440,96L1440,320L1405.7,320C1371.4,320,1303,320,1234,320C1165.7,320,1097,320,1029,320C960,320,891,320,823,320C754.3,320,686,320,617,320C548.6,320,480,320,411,320C342.9,320,274,320,206,320C137.1,320,69,320,34,320L0,320Z"></path>
        </svg>
    </footer>
    <!-- Footer End -->

    <!-- Script and Libraries -->
     <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/jsbarcode/dist/JsBarcode.all.min.js"></script>

     <script>
        // Global JSON Data to store scanned info
        let scannedData = {
            "barcodeData": "",
            "qrCodeData": ""
        };
        // Function to generate Barcode
        function scanBarcode() {
            const barcodeInput = document.getElementById("barcodeInput").value;
            if (barcodefInput) {
                scannedData.barcodeData = barcodeInput; // Save the scanned barcode data
                displayBarcode(); // Show the barcode
            }
            else {
                alert("PLease enter data to scan.");
            }
        }
        // Function to simulate QR Code
        function scanQRcode(){
            const qrInput = document.getElementById("qrInput").value;
            if(qrInput){
                scannedData.qrCodeData = qrInput; // Save the scanned QR code data
                displayQRCode(); //Show the Qr Code
            }
            else{
                alert("PLease4 enter data to scan.")
            }
        }
        //Function to display the Barcode
        function displayBarcode(){
            const barcodeContainer = document.getElementById("barcode");
            barcodeContainer.innerHTML = ""; //Clear any previous barcode
            JsBarcode(barcodeContainer, scannedData.barcodeData, {
                format: "CODE128",
                displayValue: true
            });
        }
        //Fucntion to display the QR Code
        function displayQRCode(){
            const qrContainer = document.getElementById("qrcode");
            qrContainer.innerHTML = ""; //Clear any previous QR code
            QRCode.toCanvas(qrCodeCoontainer, scannedData.qrCodeData, function (error){
                if(error) console.error(error);
            });
        }
        //Generate QR and Barcode when data is scanned and stored
        function generteQRCodeBarcode(){
            //Examplae data that would be generated upon scanning
            const qrData = "https://www.example.com";
            const barcodeData = "1234567890";
            //Update JSON with scanned Data
            scannedData.qrCodeData = qrData;
            scannedData.barcode = barcodeData;
            //Show Qr Code and Barcode
            displayQRCode();
            displayBarcode();
        }
        async function fetchMilkData(){
            try{
                const response = await fetch('/raw-milk-data');
                if (!response.ok) throw new Error('Network response was not ok');
            const data = await response.json();
            // Debugging: Log the data received
            console.log('Fetched Data:', data);
            //Update the DOM with the fetched data
            document.getElementById('displayPersonInCharge').textContent = data.person_in_charge || 'N/A';
            document.getElementById('displayMilkTankNum').textContent = data.milk_tank_number || 'N/A';
            document.getElementById('displayQuantity').textContent = data.quantity || 'N/A';
            document.getElementById('displayQuantityUnit').textContent = data.quantity_unit || 'N/A';
            document.getElementById('displayTemperature').textContent = data.temperature || 'N/A';
            document.getElementById('displayTemperatureUnit').textContent = data.temperature_unit || 'N/A';
            document.getElementById('displayQualityPh').textContent = data.quality_ph || 'N/A';
            document.getElementById('displayQualityFat').textContent = data.quality_fat || 'N/A';
            document.getElementById('displayQualityProtein').textContent = data.quality_protein || 'N/A';
            document.getElementById('displayBacterialTesting').textContent = data.bacterial_testing ? "Negative" : "Positive";
            document.getElementById('displayContaminants').textContent = data.contaminants ? "None" : "Present";
            document.getElementById('displayAbnormalCharacteristics').textContent = (data.sour_taste ? "Sour Taste, " : "") +
            (data.bitter_taste ? "Bitter Taste, " : "") +
            (data.cloudy_appearance ? "Cloudy Appearance, " : "") +
            (data.lumpy_appearance ? "Lumpy Appearance, " : "") +
            (data.water_and_fat ? "Water and Fat, " : "") +
            (data.smell_bad ? "Bad Smell, " : "") +
            (data.smell_not_fresh ? "Not Fresh, " : "") +
            (data.abnormal_color ? "Abnormal Color" : "") || 'None';
            document.getElementById('displayAddress').textContent = data.address || 'N/A';
            document.getElementById('displayLocation').innerHTML = `<a href="${data.location_url}" target="_blank">Google Maps Link</a>` || 'N/A';
        } catch
        (error) {
            console.error('Error fetching data: ', error);
            alert('Failed to fetch data from the server.');
            }
        }

        //Fetch Data on page load
        window.onload = fetchMilkData; generteQRCodeBarcode;
     </script>
     <!-- JAVASCRIPT FILES -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.sticky.js"></script>
    <script src="js/click-scroll.js"></script>
    <script src="js/animated-headline.js"></script>
    <script src="js/modernizr.js"></script>
    <script src="js/custom.js"></script>
</body>
</html>